name: Windows CI

on:
  push:
    branches: [ main, dev, master ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:   # ğŸ‘ˆ å¯æ‰‹åŠ¨è§¦å‘

jobs:
  test-on-windows:
    name: Test on Windows
    runs-on: windows-latest

    steps:
    - name: æ£€å‡ºä»£ç 
      uses: actions/checkout@v4

    - name: è®¾ç½® Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'
        cache-dependency-path: './test2/package-lock.json'  # ğŸ‘ˆ å…³é”®ä¿®æ”¹

    - name: æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯
      run: |
        echo "Windows ç‰ˆæœ¬:"
        systeminfo | findstr /B /C:"OS åç§°"
        echo "Node ç‰ˆæœ¬:"
        node --version
        echo "npm ç‰ˆæœ¬:"
        npm --version

    - name: å®‰è£…ä¾èµ–
      run: npm ci
      working-directory: ./test2

    - name: è¿è¡Œæµ‹è¯•
      run: npm test
      working-directory: ./test2

    - name: æ˜¾ç¤ºæµ‹è¯•ç»“æœ
      if: always()
      run: |
        echo "æµ‹è¯•å®Œæˆï¼"
        echo "å¯åœ¨ Actions é¡µé¢æŸ¥çœ‹è¯¦ç»†æ—¥å¿—"

